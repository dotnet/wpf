
<!--=================================================================
Licensed to the .NET Foundation under one or more agreements.
The .NET Foundation licenses this file to you under the MIT license.

Theme Styles For Windows Presentation Foundation Version 
==================================================================-->

<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:classic="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Classic"

                    xmlns:controls="clr-namespace:System.Windows.Controls"
                    xmlns:ribbon="clr-namespace:System.Windows.Controls.Ribbon"
                    xmlns:primitives="clr-namespace:System.Windows.Controls.Ribbon.Primitives"
                    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
                    xmlns:windows="clr-namespace:System.Windows;assembly=PresentationFramework"
                    xmlns:coreInternal="clr-namespace:MS.Internal;assembly=PresentationCore"







                    xmlns:system="clr-namespace:System;assembly=mscorlib">

    <primitives:RibbonWindowSmallIconConverter x:Key="RibbonWindowSmallIconConverter"/>
    <Style x:Key="{ComponentResourceKey TypeInTargetAssembly={x:Type ribbon:Ribbon},ResourceId=RibbonWindowStyle}" TargetType="{x:Type ribbon:RibbonWindow}">
        <Setter Property="shell:WindowChrome.WindowChrome" Value="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type ribbon:Ribbon},ResourceId=WindowChromeAeroBasic}}" />
        <Setter Property="Background" Value="White"/>
        <Setter Property="BorderBrush" Value="{x:Null}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ribbon:RibbonWindow}">
                    <ControlTemplate.Resources>

                        <Style TargetType="{x:Type Button}" x:Key="AeroCaptionBaseButtonStyle">
                            <Style.Resources>
                                <LinearGradientBrush x:Key="AeroCaptionButtonGradient" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFC3D4E7" Offset="0"/>
                                    <GradientStop Color="#FFBFD3E8" Offset="0.47"/>
                                    <GradientStop Color="#FF98B1CC" Offset="0.47"/>
                                    <GradientStop Color="#FFB7D0E9" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="ActiveAeroCaptionButtonBorderGradient" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FF5D6F88" Offset="0.0"/>
                                    <GradientStop Color="#FF697A92" Offset="1.0"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHighlightGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFDFE8F2" Offset="0"/>
                                    <GradientStop Color="#FFDDE7F3" Offset="0.47"/>
                                    <GradientStop Color="#FFC8D5E4" Offset="0.47"/>
                                    <GradientStop Color="#FFD9E7F4" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHoverHighlightGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFD6EBFA" Offset="0"/>
                                    <GradientStop Color="#FFBBDDF3" Offset="0.47"/>
                                    <GradientStop Color="#FF8EB4CE" Offset="0.47"/>
                                    <GradientStop Color="#FF8CD1EE" Offset="0.87"/>
                                    <GradientStop Color="#FF89E0F4" Offset="0.87"/>
                                    <GradientStop Color="#FF85EFF9" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonPressedHighlightGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFACBEC9" Offset="0"/>
                                    <GradientStop Color="#FF90A2B1" Offset="0.47"/>
                                    <GradientStop Color="#FF667888" Offset="0.47"/>
                                    <GradientStop Color="#FF68939F" Offset="0.73"/>
                                    <GradientStop Color="#FF6BADB4" Offset="0.73"/>
                                    <GradientStop Color="#FF67E6E4" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHoverGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFAAD5F3" Offset="0"/>
                                    <GradientStop Color="#FF81C0EA" Offset="0.47"/>
                                    <GradientStop Color="#FF2D73A3" Offset="0.47"/>
                                    <GradientStop Color="#FF24C6EB" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonPressedGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FF7F9AAC" Offset="0"/>
                                    <GradientStop Color="#FF5D778C" Offset="0.47"/>
                                    <GradientStop Color="#FF203B52" Offset="0.47"/>
                                    <GradientStop Color="#FF1F4158" Offset="0.68"/>
                                    <GradientStop Color="#FF236273" Offset="0.68"/>
                                    <GradientStop Color="#FF27C9C8" Offset="1"/>
                                </LinearGradientBrush>
                            </Style.Resources>
                            <Setter Property="Background" Value="{StaticResource AeroCaptionButtonGradient}"/>
                            <Setter Property="BorderBrush" Value="{StaticResource ActiveAeroCaptionButtonBorderGradient}"/>
                            <Setter Property="Padding" Value="8,2"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type Button}">
                                        <ControlTemplate.Resources>
                                            <LinearGradientBrush x:Key="InactiveBorderGradient" StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Color="#FF838EA8" Offset="0.0"/>
                                                <GradientStop Color="#FF8893AD" Offset="1.0"/>
                                            </LinearGradientBrush>
                                            <LinearGradientBrush x:Key="GlyphBackgroundBorderInactiveBrush" StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Color="#FFBDCBDA" Offset="0.0"/>
                                                <GradientStop Color="#FFCEDCEB" Offset="1"/>
                                            </LinearGradientBrush>
                                            <LinearGradientBrush x:Key="InnerHighlightInactiveBrush" StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Color="#FFD1DBE5" Offset="0.0"/>
                                                <GradientStop Color="#FFDFE8F3" Offset="1"/>
                                            </LinearGradientBrush>
                                        </ControlTemplate.Resources>
                                        <Grid>
                                            <Border CornerRadius="2" BorderBrush="{TemplateBinding BorderBrush}"
                                                    Background="{TemplateBinding Background}"
                                                    BorderThickness="1"
                                                    Width="{TemplateBinding Width}"
                                                    Height="{TemplateBinding Height}">
                                                <Border Name="InnerHighlightBorder" CornerRadius="2" BorderBrush="{DynamicResource {ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHighlightGradient}}" BorderThickness="1"/>
                                            </Border>
                                            <Border x:Name="GlyphBackgroundBorder" Margin="2">
                                                <Rectangle Margin="{TemplateBinding Padding}" Fill="{TemplateBinding Foreground}"/>
                                            </Border>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding Path=IsActive, RelativeSource={RelativeSource AncestorType=Window}}" Value="False"/>
                                                    <Condition Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource Self}}" Value="False"/>
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.GradientInactiveCaptionBrushKey}}"/>
                                                <Setter Property="BorderBrush" Value="{StaticResource InactiveBorderGradient}"/>
                                                <Setter TargetName="GlyphBackgroundBorder" Property="Background" Value="{StaticResource GlyphBackgroundBorderInactiveBrush}"/>
                                                <Setter TargetName="InnerHighlightBorder" Property="BorderBrush" Value="{StaticResource InnerHighlightInactiveBrush}"/>
                                            </MultiDataTrigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="{DynamicResource {ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHoverGradient}}"/>
                                                <Setter TargetName="InnerHighlightBorder" Property="BorderBrush" Value="{DynamicResource {ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHoverHighlightGradient}}"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter TargetName="InnerHighlightBorder" Property="BorderBrush" Value="{DynamicResource {ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonPressedHighlightGradient}}"/>
                                                <Setter Property="Background" Value="{DynamicResource {ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonPressedGradient}}"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>

                        <Style BasedOn="{StaticResource AeroCaptionBaseButtonStyle}" TargetType="{x:Type Button}" x:Key="AeroMinimizeButtonStyle">
                            <Setter Property="Padding" Value="8,6,8,2"/>
                        </Style>

                        <Style BasedOn="{StaticResource AeroCaptionBaseButtonStyle}" TargetType="{x:Type Button}" x:Key="AeroRestoreButtonStyle">
                            <Setter Property="Padding" Value="7,1,8,1"/>
                        </Style>

                        <Style BasedOn="{StaticResource AeroCaptionBaseButtonStyle}" TargetType="{x:Type Button}" x:Key="AeroCloseButtonStyle">
                            <Style.Resources>
                                <LinearGradientBrush x:Key="AeroCloseButtonGradient" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFE9A99C" Offset="0.0"/>
                                    <GradientStop Color="#FFDF9587" Offset="0.47"/>
                                    <GradientStop Color="#FFB8432C" Offset="0.47"/>
                                    <GradientStop Color="#FFD27F6F" Offset="1"/>
                                </LinearGradientBrush>
                                <SolidColorBrush x:Key="ActiveAeroCloseButtonBorderBrush" Color="#FF431422"/>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHighlightGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFF4D3CC" Offset="0.0"/>
                                    <GradientStop Color="#FFEDC4BD" Offset="0.47"/>
                                    <GradientStop Color="#FFD99A8E" Offset="0.47"/>
                                    <GradientStop Color="#FFECC6C0" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHoverHighlightGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFFDE4E0" Offset="0.0"/>
                                    <GradientStop Color="#FFFCCEC6" Offset="0.47"/>
                                    <GradientStop Color="#FFE78977" Offset="0.47"/>
                                    <GradientStop Color="#FFEEB495" Offset="0.87"/>
                                    <GradientStop Color="#FFF3CCA4" Offset="0.87"/>
                                    <GradientStop Color="#FFFAEE6B" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonPressedHighlightGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFDDC7BC" Offset="0.0"/>
                                    <GradientStop Color="#FFCCB0A5" Offset="0.47"/>
                                    <GradientStop Color="#FFB28176" Offset="0.47"/>
                                    <GradientStop Color="#FFC2A489" Offset="0.87"/>
                                    <GradientStop Color="#FFCDB697" Offset="0.87"/>
                                    <GradientStop Color="#FFF2E682" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonHoverGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFFCC8BF" Offset="0.0"/>
                                    <GradientStop Color="#FFFAA99A" Offset="0.47"/>
                                    <GradientStop Color="#FFD22302" Offset="0.47"/>
                                    <GradientStop Color="#FFE5934D" Offset="1"/>
                                </LinearGradientBrush>
                                <LinearGradientBrush x:Key="{ComponentResourceKey {x:Type RibbonWindow}, AeroCaptionButtonPressedGradient}" StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFC49982" Offset="0.0"/>
                                    <GradientStop Color="#FFB37B63" Offset="0.47"/>
                                    <GradientStop Color="#FF831800" Offset="0.47"/>
                                    <GradientStop Color="#FF831800" Offset="0.68"/>
                                    <GradientStop Color="#FF832A01" Offset="0.68"/>
                                    <GradientStop Color="#FFB98C47" Offset="1"/>
                                </LinearGradientBrush>
                                <SolidColorBrush x:Key="AeroCloseButtonHoverBorderBrush" Color="#FF720000"/>
                            </Style.Resources>
                            <Setter Property="Background" Value="{StaticResource AeroCloseButtonGradient}"/>
                            <Setter Property="BorderBrush" Value="{StaticResource ActiveAeroCloseButtonBorderBrush}"/>
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource Self}}" Value="True"/>
                                        <Condition Binding="{Binding Path=IsActive, RelativeSource={RelativeSource AncestorType=Window}}" Value="False"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="BorderBrush" Value="{StaticResource AeroCloseButtonHoverBorderBrush}"/>
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>

                        <SolidColorBrush x:Key="InactiveWindowBorderTopHighlightBrush" Color="#FFE2E6EF"/>
                        <SolidColorBrush x:Key="InactiveWindowBorderHighlightBrush" Color="#FFE9ECF3"/>

                        <SolidColorBrush x:Key="OuterBorderDisabledBrush" Color="#FF4C4C4C"/>

                        <LinearGradientBrush x:Key="InactiveWindowTopBorderOverlayBrush" StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#02FFFFFF" Offset="0.0"/>
                            <GradientStop Color="#FF4C4C4C" Offset="0.33"/>
                        </LinearGradientBrush>

                        <LinearGradientBrush x:Key="ActiveWindowBorderShadowBrush" StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#FFC1EEF5" Offset="0.0"/>
                            <GradientStop Color="#FF83DEF4" Offset="0.2"/>
                            <GradientStop Color="#FF42CFF2" Offset="0.5"/>
                            <GradientStop Color="#FF28CFE4" Offset="0.95"/>
                        </LinearGradientBrush>

                        <LinearGradientBrush x:Key="AeroBasicCaptionButtonGlyphBrush" StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#FFFFFFFF" Offset="0.0"/>
                            <GradientStop Color="#FFFAFAFA" Offset="0.47"/>
                            <GradientStop Color="#FFE9E9E9" Offset="0.47"/>
                            <GradientStop Color="#FFD7D7D7" Offset="1"/>
                        </LinearGradientBrush>

                        <LinearGradientBrush x:Key="AeroActiveTitlePanelOverlayBrush" StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#3000365D" Offset="0.0"/>
                            <GradientStop Color="#00000000" Offset="1.0"/>
                        </LinearGradientBrush>

                        <LinearGradientBrush x:Key="AeroInactiveTitlePanelOverlayBrush" StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#1D001A2A" Offset="0.0"/>
                            <GradientStop Color="#00000000" Offset="1.0"/>
                        </LinearGradientBrush>

                        <LinearGradientBrush x:Key="AeroActiveWindowBackgroundSideOverlayBrush" StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#00FFFFFF" Offset="0.0"/>
                            <GradientStop Color="#00FFFFFF" Offset="0.30"/>
                            <GradientStop Color="#70FFFFFF" Offset="0.85"/>
                            <GradientStop Color="#80FFFFFF" Offset="0.98"/>
                            <GradientStop Color="#70FFFFFF" Offset="0.99"/>
                            <GradientStop Color="#00FFFFFF" Offset="1.0"/>
                        </LinearGradientBrush>

                        <LinearGradientBrush x:Key="AeroInactiveWindowBackgroundTopOverlayBrush" StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#16000000" Offset="0.0"/>
                            <GradientStop Color="#00000000" Offset="0.33"/>
                        </LinearGradientBrush>

                    </ControlTemplate.Resources>

                    <Grid>

                        <Border Name="NonClientAreaBorder"

                                BorderThickness="{Binding Path=(SystemParameters.WindowNonClientFrameThickness)}"



                                BorderBrush="{DynamicResource {x:Static SystemColors.GradientActiveCaptionBrushKey}}">
                            <Border Name="PART_ClientAreaBorder"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"/>
                        </Border>

                        <StackPanel>
                            <Border Name="TitlePanelOverlay"
                                    VerticalAlignment="Top"
                                    Background="{StaticResource AeroActiveTitlePanelOverlayBrush}"

                                    Height="{Binding Path=(SystemParameters.WindowNonClientFrameThickness).Top}"/>




                            <Grid Height="90">
                                <Rectangle x:Name="AeroLeftHighlightOverlay"
                                           Fill="{StaticResource AeroActiveWindowBackgroundSideOverlayBrush}"
                                           Width="{Binding Path=(shell:WindowChrome.WindowChrome).ResizeBorderThickness.Left, RelativeSource={RelativeSource TemplatedParent}}"
                                           HorizontalAlignment="Left"/>
                                <Rectangle x:Name="AeroRightHighlightOverlay"
                                           Fill="{StaticResource AeroActiveWindowBackgroundSideOverlayBrush}"
                                           Width="{Binding Path=(shell:WindowChrome.WindowChrome).ResizeBorderThickness.Right, RelativeSource={RelativeSource TemplatedParent}}"
                                           HorizontalAlignment="Right"/>
                            </Grid>
                        </StackPanel>

                        <Border Name="OuterBorder"
                                BorderThickness="1"
                                BorderBrush="Black"

                                CornerRadius="{Binding Path=(SystemParameters.WindowCornerRadius)}">



                            <Grid>
                                <Border Name="WindowHighlightBorder"
                                        BorderThickness="1,1,0,0"
                                        BorderBrush="White"

                                        CornerRadius="{Binding Path=(SystemParameters.WindowCornerRadius)}">




                                    <Grid VerticalAlignment="Top"
                                          Margin="{Binding Path=(shell:WindowChrome.WindowChrome).ResizeBorderThickness, RelativeSource={RelativeSource TemplatedParent}}">

                                        <Image Name="PART_Icon"
                                               shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                               Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon, Converter={StaticResource RibbonWindowSmallIconConverter}}"
                                               HorizontalAlignment="Left"

                                               Width="{Binding Path=(SystemParameters.SmallIconWidth)}"
                                               Height="{Binding Path=(SystemParameters.SmallIconHeight)}"/>





                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Right"

                                                    Height="{Binding Path=(SystemParameters.WindowCaptionButtonHeight)}">



                                            <Button Name="PART_MinimizeWindowButton" Focusable="False"
                                                    shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                                    Command="windows:SystemCommands.MinimizeWindowCommand"
                                                    Style="{StaticResource AeroMinimizeButtonStyle}"

                                                    Margin="0,0,0,4"

                                                    Width="31">
                                                <Button.Foreground>
                                                    <DrawingBrush>
                                                        <DrawingBrush.Drawing>
                                                            <DrawingGroup>
                                                                <GeometryDrawing Brush="{StaticResource AeroBasicCaptionButtonGlyphBrush}">
                                                                    <GeometryDrawing.Pen>
                                                                        <Pen Brush="Black" Thickness="5"/>
                                                                    </GeometryDrawing.Pen>
                                                                    <GeometryDrawing.Geometry>
                                                                        <PathGeometry>
                                                                            <PathFigure StartPoint="10,20" IsClosed="True">
                                                                                <LineSegment Point="10,40" />
                                                                                <LineSegment Point="20,50" />
                                                                                <LineSegment Point="100,50" />
                                                                                <LineSegment Point="110,40" />
                                                                                <LineSegment Point="110,20" />
                                                                                <LineSegment Point="100,10" />
                                                                                <LineSegment Point="20,10" />
                                                                            </PathFigure>
                                                                        </PathGeometry>
                                                                    </GeometryDrawing.Geometry>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>
                                                        </DrawingBrush.Drawing>
                                                    </DrawingBrush>
                                                </Button.Foreground>
                                            </Button>
                                            <Button Name="PART_MaximizeWindowButton" Focusable="False"
                                                    shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                                    Command="windows:SystemCommands.MaximizeWindowCommand"
                                                    Style="{StaticResource AeroCaptionBaseButtonStyle}"

                                                    Margin="2,0,0,4"



                                                    Width="31">
                                                <Button.Foreground>
                                                    <DrawingBrush>
                                                        <DrawingBrush.Drawing>
                                                            <DrawingGroup>
                                                                <GeometryDrawing Brush="{StaticResource AeroBasicCaptionButtonGlyphBrush}">
                                                                    <GeometryDrawing.Pen>
                                                                        <Pen Brush="Black" Thickness="5"/>
                                                                    </GeometryDrawing.Pen>
                                                                    <GeometryDrawing.Geometry>
                                                                        <PathGeometry>
                                                                            <PathFigure StartPoint="10,20" IsClosed="True">
                                                                                <LineSegment Point="10,80" />
                                                                                <LineSegment Point="20,90" />
                                                                                <LineSegment Point="100,90" />
                                                                                <LineSegment Point="110,80" />
                                                                                <LineSegment Point="110,20" />
                                                                                <LineSegment Point="100,10" />
                                                                                <LineSegment Point="20,10" />
                                                                            </PathFigure>
                                                                            <PathFigure StartPoint="40,40" IsClosed="True">
                                                                                <LineSegment Point="40,60" />
                                                                                <LineSegment Point="80,60" />
                                                                                <LineSegment Point="80,40" />
                                                                            </PathFigure>
                                                                        </PathGeometry>
                                                                    </GeometryDrawing.Geometry>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>
                                                        </DrawingBrush.Drawing>
                                                    </DrawingBrush>
                                                </Button.Foreground>
                                            </Button>
                                            <Button Name="PART_RestoreWindowButton" Focusable="False"
                                                    shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                                    Command="windows:SystemCommands.RestoreWindowCommand"
                                                    Style="{StaticResource AeroRestoreButtonStyle}"

                                                    Margin="2,0,0,4"



                                                    Width="31"
                                                    Visibility="Collapsed">
                                                <Button.Foreground>
                                                    <DrawingBrush>
                                                        <DrawingBrush.Drawing>
                                                            <DrawingGroup>
                                                                <GeometryDrawing Brush="{StaticResource AeroBasicCaptionButtonGlyphBrush}">
                                                                    <GeometryDrawing.Pen>
                                                                        <Pen Brush="Black" Thickness="5"/>
                                                                    </GeometryDrawing.Pen>
                                                                    <GeometryDrawing.Geometry>
                                                                        <PathGeometry>
                                                                            <PathFigure StartPoint="40,10" IsClosed="True">
                                                                                <LineSegment Point="40,60" />
                                                                                <LineSegment Point="50,70" />
                                                                                <LineSegment Point="100,70" />
                                                                                <LineSegment Point="110,60" />
                                                                                <LineSegment Point="110,10" />
                                                                                <LineSegment Point="100,0" />
                                                                                <LineSegment Point="50,0" />
                                                                            </PathFigure>
                                                                            <PathFigure StartPoint="60,30" IsClosed="True">
                                                                                <LineSegment Point="60,50" />
                                                                                <LineSegment Point="90,50" />
                                                                                <LineSegment Point="90,30" />
                                                                            </PathFigure>
                                                                        </PathGeometry>
                                                                    </GeometryDrawing.Geometry>
                                                                </GeometryDrawing>
                                                                <GeometryDrawing Brush="{StaticResource AeroBasicCaptionButtonGlyphBrush}">
                                                                    <GeometryDrawing.Pen>
                                                                        <Pen Brush="Black" Thickness="5"/>
                                                                    </GeometryDrawing.Pen>
                                                                    <GeometryDrawing.Geometry>
                                                                        <PathGeometry>
                                                                            <PathFigure StartPoint="0,40" IsClosed="True">
                                                                                <LineSegment Point="0,90" />
                                                                                <LineSegment Point="10,100" />
                                                                                <LineSegment Point="60,100" />
                                                                                <LineSegment Point="70,90" />
                                                                                <LineSegment Point="70,40" />
                                                                                <LineSegment Point="60,30" />
                                                                                <LineSegment Point="10,30" />
                                                                            </PathFigure>
                                                                            <PathFigure StartPoint="20,60" IsClosed="True">
                                                                                <LineSegment Point="20,80" />
                                                                                <LineSegment Point="50,80" />
                                                                                <LineSegment Point="50,60" />
                                                                            </PathFigure>
                                                                        </PathGeometry>
                                                                    </GeometryDrawing.Geometry>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>
                                                        </DrawingBrush.Drawing>
                                                    </DrawingBrush>
                                                </Button.Foreground>
                                            </Button>
                                            <Button Name="PART_CloseWindowButton" Focusable="False"
                                                    shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                                    Command="windows:SystemCommands.CloseWindowCommand"
                                                    Style="{StaticResource AeroCloseButtonStyle}"

                                                    Margin="2,0,0,4"



                                                    Width="31">
                                                <Button.Foreground>
                                                    <DrawingBrush>
                                                        <DrawingBrush.Drawing>
                                                            <DrawingGroup>
                                                                <GeometryDrawing Brush="{StaticResource AeroBasicCaptionButtonGlyphBrush}">
                                                                    <GeometryDrawing.Pen>
                                                                        <Pen Brush="Black" Thickness="5"/>
                                                                    </GeometryDrawing.Pen>
                                                                    <GeometryDrawing.Geometry>
                                                                        <PathGeometry>
                                                                            <PathFigure StartPoint="10,20" IsClosed="True">
                                                                                <LineSegment Point="40,50" />
                                                                                <LineSegment Point="10,80" />
                                                                                <LineSegment Point="20,90" />
                                                                                <LineSegment Point="40,90" />
                                                                                <LineSegment Point="60,70" />
                                                                                <LineSegment Point="80,90" />
                                                                                <LineSegment Point="100,90" />
                                                                                <LineSegment Point="110,80" />
                                                                                <LineSegment Point="80,50" />
                                                                                <LineSegment Point="110,20" />
                                                                                <LineSegment Point="100,10" />
                                                                                <LineSegment Point="80,10" />
                                                                                <LineSegment Point="60,30" />
                                                                                <LineSegment Point="40,10" />
                                                                                <LineSegment Point="20,10" />
                                                                            </PathFigure>
                                                                        </PathGeometry>
                                                                    </GeometryDrawing.Geometry>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>
                                                        </DrawingBrush.Drawing>
                                                    </DrawingBrush>
                                                </Button.Foreground>
                                            </Button>
                                        </StackPanel>

                                    </Grid>
                                </Border>

                                <Border Name="WindowShadowBorder"
                                        BorderThickness="0,0,1,1"
                                        BorderBrush="{StaticResource ActiveWindowBorderShadowBrush}"

                                        CornerRadius="{Binding Path=(SystemParameters.WindowCornerRadius)}"/>



                            </Grid>
                        </Border>

                        <Border BorderThickness="{Binding Path=(shell:WindowChrome.WindowChrome).ResizeBorderThickness, RelativeSource={RelativeSource TemplatedParent}}">
                          <Grid>
                            <AdornerDecorator>
                                <ContentPresenter Name="PART_RootContentPresenter"/>
                            </AdornerDecorator>
                            <ResizeGrip x:Name="WindowResizeGrip"
                                        shell:WindowChrome.ResizeGripDirection="BottomRight"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Bottom"
                                        Visibility="Collapsed"
                                        IsTabStop="false"/>
                          </Grid>
                        </Border>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsActive" Value="False">
                            <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource OuterBorderDisabledBrush}"/>

                            <Setter TargetName="TitlePanelOverlay" Property="Background" Value="{StaticResource AeroInactiveTitlePanelOverlayBrush}"/>

                            <Setter TargetName="AeroLeftHighlightOverlay" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="AeroRightHighlightOverlay" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="WindowHighlightBorder" Property="BorderBrush" Value="{StaticResource InactiveWindowBorderHighlightBrush}"/>
                            <Setter TargetName="WindowShadowBorder" Property="BorderBrush" Value="{StaticResource InactiveWindowBorderHighlightBrush}"/>
                            <Setter TargetName="NonClientAreaBorder" Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.GradientInactiveCaptionBrushKey}}"/>
                        </Trigger>
                        <Trigger Property="WindowState" Value="Maximized">
                            <Setter TargetName="PART_MaximizeWindowButton" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="PART_RestoreWindowButton" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="Icon" Value="{x:Null}">

                            <Setter TargetName="PART_Icon" Property="Source" Value="/System.Windows.Controls.Ribbon;component/Images/DefaultSystemIcon.png"/>



                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Window.ResizeMode"
                                           Value="CanResizeWithGrip"/>
                                <Condition Property="Window.WindowState"
                                           Value="Normal"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="WindowResizeGrip"
                                    Property="Visibility"
                                    Value="Visible"/>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <Style.Triggers>



            <DataTrigger Binding="{Binding Path=(SystemParameters.IsGlassEnabled)}" Value="True">



                <Setter Property="shell:WindowChrome.WindowChrome" Value="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type ribbon:Ribbon},ResourceId=WindowChromeAeroWithGlass}}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ribbon:RibbonWindow}">
                            <Grid>
                                <Border Name="PART_ClientAreaBorder"

                                        Margin="{Binding Path=(SystemParameters.WindowNonClientFrameThickness)}"



                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"/>

                                <Border BorderThickness="{Binding Path=(shell:WindowChrome.WindowChrome).ResizeBorderThickness, RelativeSource={RelativeSource TemplatedParent}}">
                                    <Grid>
                                        <Image Name="PART_Icon"
                                               shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                               Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon, Converter={StaticResource RibbonWindowSmallIconConverter}}"
                                               HorizontalAlignment="Left"
                                               VerticalAlignment="Top"

                                               Width="{Binding Path=(SystemParameters.SmallIconWidth)}"
                                               Height="{Binding Path=(SystemParameters.SmallIconHeight)}"/>




                                        <AdornerDecorator>
                                            <ContentPresenter Name="PART_RootContentPresenter"/>
                                        </AdornerDecorator>
                                        <ResizeGrip x:Name="WindowResizeGrip"
                                                    shell:WindowChrome.ResizeGripDirection="BottomRight"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Bottom"
                                                    Visibility="Collapsed"
                                                    IsTabStop="false"/>
                                    </Grid>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="Icon" Value="{x:Null}">

                                    <Setter TargetName="PART_Icon" Property="Source" Value="/System.Windows.Controls.Ribbon;component/Images/GlassyDefaultSystemIcon.png"/>



                                </Trigger>
                                <Trigger Property="WindowState" Value="Maximized">
                                    <Setter TargetName="PART_Icon" Property="Margin" Value="0,2,0,0"/>
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="Window.ResizeMode"
                                                   Value="CanResizeWithGrip"/>
                                        <Condition Property="Window.WindowState"
                                                   Value="Normal"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="WindowResizeGrip"
                                            Property="Visibility"
                                            Value="Visible"/>
                                </MultiTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>

